<!doctype html>
<html lang="zh-CN">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>å…«å­—æµå¹´Â·å¤§ç™½è¯è§£è¯´ï¼ˆJulieä¸“ç”¨Â·æ¸©æŸ”ç‰ˆï¼‰</title>
<style>
  body{font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Helvetica,Arial,Apple Color Emoji;max-width:900px;margin:24px auto;padding:0 14px;line-height:1.55}
  h1{font-size:20px;margin:8px 0 14px}
  .card{border:1px solid #eee;border-radius:12px;padding:14px;margin:12px 0;background:#fff}
  label{display:block;margin:10px 0 6px}
  input,select,button,textarea{width:100%;padding:10px;border:1px solid #ddd;border-radius:10px;font-size:16px}
  button{cursor:pointer}
  .row{display:grid;grid-template-columns:1fr 1fr;gap:10px}
  .muted{color:#777;font-size:13px}
  .mono{font-family:ui-monospace,Menlo,Monaco,Consolas,monospace}
  .pill{display:inline-block;padding:2px 8px;border:1px solid #eee;border-radius:999px;margin-right:6px;font-size:12px}
</style>
<script src="https://cdn.jsdelivr.net/npm/lunar-javascript/lunar.js"></script>
</head>
<body>
<h1>å…«å­—æµå¹´ Â· å¤§ç™½è¯è§£è¯´ï¼ˆJulieä¸“ç”¨Â·æ¸©æŸ”ç‰ˆï¼‰</h1>

<div class="card">
  <div class="row">
    <div>
      <label>å‘½ä¸»å§“åï¼ˆå¯ç•™ç©ºï¼‰</label>
      <input id="name" placeholder="ä¾‹ï¼šç‹å°æ˜"/>
    </div>
    <div>
      <label>æ€§åˆ«ï¼ˆå¯ç•™ç©ºï¼‰</label>
      <select id="gender">
        <option value="">ä¸å¡«</option><option>ç”·</option><option>å¥³</option>
      </select>
    </div>
  </div>

  <label>å…¬å†ç”Ÿæ—¥ï¼ˆå¿…å¡«ï¼‰</label>
  <input id="date" type="date"/>

  <div class="row">
    <div>
      <label>å‡ºç”Ÿæ—¶é—´ï¼ˆæœªçŸ¥å¯é€‰â€œæœªçŸ¥â€ï¼‰</label>
      <select id="time">
        <option value="">æœªçŸ¥</option>
        <option>00:00</option><option>01:00</option><option>02:00</option><option>03:00</option>
        <option>04:00</option><option>05:00</option><option>06:00</option><option>07:00</option>
        <option>08:00</option><option>09:00</option><option>10:00</option><option>11:00</option>
        <option>12:00</option><option>13:00</option><option>14:00</option><option>15:00</option>
        <option>16:00</option><option>17:00</option><option>18:00</option><option>19:00</option>
        <option>20:00</option><option>21:00</option><option>22:00</option><option>23:00</option>
      </select>
    </div>
    <div>
      <label>å‡ºç”Ÿåœ°æ—¶åŒºï¼ˆé»˜è®¤UTC+8 é©¬æ¥è¥¿äºš/æ–°åŠ å¡ï¼‰</label>
      <select id="tz">
        <option value="8" selected>UTC+8</option>
        <option value="7">UTC+7</option><option value="9">UTC+9</option>
        <option value="0">UTCÂ±0</option><option value="-5">UTC-5</option><option value="-8">UTC-8</option>
      </select>
    </div>
  </div>

  <div class="row">
    <div>
      <label>æŸ¥çœ‹å“ªä¸€å¹´çš„æµå¹´ï¼ˆé»˜è®¤å½“å‰å¹´ï¼‰</label>
      <input id="flowYear" type="number" min="1900" max="2100"/>
    </div>
    <div>
      <label>è¾“å‡ºè¯­æ°”</label>
      <select id="tone">
        <option value="gentle" selected>æ¸©æŸ”å®‰å®š</option>
        <option value="professional">ä¸“ä¸šç¨³é‡</option>
        <option value="concise">ç®€æ´æ˜å¿«</option>
      </select>
    </div>
  </div>

  <div style="margin-top:12px">
    <button onclick="run()">ç”Ÿæˆè§£è¯´</button>
  </div>
</div>

<div class="card">
  <label>å…«å­—æ’ç›˜ï¼ˆå‚è€ƒï¼‰</label>
  <pre id="chart" class="mono" style="white-space:pre-wrap"></pre>
  <div id="tags"></div>
</div>

<div class="card">
  <label>å¯å¤åˆ¶ç»™å‘½ä¸»çš„ WhatsApp æ–‡æ¡ˆï¼ˆæ¸©æŸ”ç‰ˆï¼‰</label>
  <textarea id="wa" rows="20" class="mono"></textarea>
  <div class="row" style="margin-top:10px">
    <button onclick="copyWA()">å¤åˆ¶è§£è¯´</button>
    <button onclick="downloadTxt()">ä¸‹è½½TXT</button>
  </div>
  <p class="muted">ä»…ä¾›èº«å¿ƒçµå‚è€ƒï¼Œä¸æ„æˆåŒ»ç–—/è´¢åŠ¡/æ³•å¾‹å»ºè®®ã€‚è‹¥å‡ºç”Ÿæ—¶è¾°ä¸æ˜ï¼Œæ—¶æŸ±ç›¸å…³ä»…ä½œè¾…åŠ©å‚è€ƒã€‚</p>
</div>

<script>
/* â€”â€” Julie ä¸“ç”¨ç´ æåº“ â€”â€” */
/* äº”è¡Œ â†’ æ°´æ™¶æ¸…å•ï¼ˆè¦†ç›–ä½ å¸¸ç”¨ï¼šç™½æ°´æ™¶/é»„æ°´æ™¶/èŒ¶æ™¶/ç´«æ°´æ™¶/è™çœ¼çŸ³/é»‘æ›œçŸ³/é‡‘æ›œçŸ³/å¤ªé˜³çŸ³/å—çº¢ç›ç‘™/çº¢å‘æ™¶/ä¸œé™µç‰/ç»¿å¹½çµ/ç»¿è‰è“æ™¶/è‘¡è„çŸ³/é»‘ç¢§çº/æµ·è“å®/æœˆå…‰çŸ³/æ·å…‹é™¨çŸ³/èœœèœ¡ç­‰ï¼‰ */
const CRYSTALS = {
  é‡‘:['ç™½æ°´æ™¶','ç™½é’›æ™¶','é‡‘å‘æ™¶','ç™½æ°´æ™¶æ™¶ä¸­æ™¶'],
  æœ¨:['ä¸œé™µç‰','ç»¿å¹½çµ','ç»¿è‰è“æ™¶','è‘¡è„çŸ³'],
  æ°´:['é»‘æ›œçŸ³','é»‘ç¢§çº','æµ·è“å®','æœˆå…‰çŸ³'],
  ç«:['å¤ªé˜³çŸ³','å—çº¢ç›ç‘™','çº¢å‘æ™¶','æ·å…‹é™¨çŸ³'],
  åœŸ:['é»„æ°´æ™¶','è™çœ¼çŸ³','èŒ¶æ™¶','èœœèœ¡']
};
/* åŠŸèƒ½å‘æ­é…ï¼ˆæŠ¤èº«/åŒ–ç…/è´¢è¿/è´µäºº/æƒ…ç»ª/å¥åº·ï¼‰ä¼šåœ¨æ–‡æ¡ˆé‡Œå¼•ç”¨ */
const FEATURE_SET = {
  æŠ¤èº«:['é»‘æ›œçŸ³','é‡‘æ›œçŸ³','é»‘ç¢§çº','èŒ¶æ™¶'],
  åŒ–ç…:['é»‘æ›œçŸ³','é‡‘æ›œçŸ³','è™çœ¼çŸ³','èŒ¶æ™¶'],
  è´¢è¿:['é»„æ°´æ™¶','é‡‘å‘æ™¶','è™çœ¼çŸ³','ç™½æ°´æ™¶'],
  è´µäºº:['ç™½æ°´æ™¶','ç´«æ°´æ™¶','ç»¿å¹½çµ','ç»¿è‰è“æ™¶'],
  æƒ…ç»ª:['ç´«æ°´æ™¶','æœˆå…‰çŸ³','è‘¡è„çŸ³','ä¸œé™µç‰'],
  å¥åº·:['ç™½æ°´æ™¶','èŒ¶æ™¶','èœœèœ¡','æµ·è“å®']
};
/* æ»´æºœ/æŒ‚ä»¶å»ºè®®æ±  */
const CHARMS = ['é‡‘è‰²ç¦è¢‹ï¼ˆâ€œç¦â€/é“ƒé“›ï¼‰','ç´«æ°´æ™¶é’±è¢‹å­','å¤ªé˜³çŸ³è²”è²…','ä¹¾éš†é€šå®å¤å¸'];

/* 10ml ç²¾æ²¹é…æ–¹åº“ï¼ˆæ¯ç“¶æ€»æ»´æ•°çº¦ 40ï½45 æ»´ï¼›åŸºåº•æ²¹å»ºè®®è·è·å·´ 8mlï¼‰ */
const OILS = {
  é‡‘:['ä¹³é¦™','æª€é¦™','æ²¡è¯'],
  æœ¨:['ç½—å‹’','å°¤åŠ åˆ©','ä½›æ‰‹'],
  æ°´:['è–°è¡£è‰','ä¾å…°','è“èƒ¶å°¤åŠ åˆ©'],
  ç«:['è‚‰æ¡‚','è¿·è¿­é¦™','å§œ'],
  åœŸ:['å¹¿è—¿é¦™','å²©å…°è‰','é›ªæ¾']
};
function mkOilPlan(weakKeys){
  // ä¸»è¡¥å¼±å…ƒç´ ä¸¤ç±»ï¼›è‹¥ä»…1ç±»ï¼Œè‡ªåŠ¨åŠ å…¥â€œå®‰å®šâ€æ”¶å°¾
  const pick = (arr,n)=>arr.slice(0,Math.max(1,Math.min(n,arr.length)));
  const w = weakKeys.length?weakKeys:['_å®‰å®š'];
  const plans=[];
  const drops=(pairs)=>pairs.map(x=>`${x[0]} ${x[1]}æ»´`).join(' + ');
  // æ—¥å¸¸å¹³è¡¡ï¼šå¼±å…ƒç´ å„é€‰2æ²¹
  if(weakKeys.length){
    const pairs=[];
    weakKeys.forEach(k=>{
      const oils=pick(OILS[k],2);
      pairs.push([oils[0],8],[oils[1],6]);
    });
    // å®‰å®šå°¾ï¼šä¹³é¦™æˆ–æª€é¦™ 4æ»´
    pairs.push(['ä¹³é¦™',4]);
    plans.push({name:'æ—¥å¸¸å¹³è¡¡ï¼ˆ10mlï¼‰',desc:`è·è·å·´ 8ml + ${drops(pairs)}ï¼ˆæ€»çº¦40ï½45æ»´ï¼‰`});
  }else{
    plans.push({name:'æ—¥å¸¸å¹³è¡¡ï¼ˆ10mlï¼‰',desc:`è·è·å·´ 8ml + è–°è¡£è‰ 12æ»´ + ä¹³é¦™ 8æ»´ + æª€é¦™ 6æ»´ + å²©å…°è‰ 4æ»´ + ä½›æ‰‹ 6æ»´ï¼ˆçº¦36ï½40æ»´ï¼‰`});
  }
  // é‡è¦ä¼šè°ˆ/ç­¾çº¦ï¼šåŠ ç¨³é‡ä¸æ¸…æ™°
  plans.push({name:'é‡è¦ä¼šè°ˆ/ç­¾çº¦ï¼ˆ10mlï¼‰',desc:`è·è·å·´ 8ml + ä¹³é¦™ 10æ»´ + æª€é¦™ 8æ»´ + è¿·è¿­é¦™ 6æ»´ + ä½›æ‰‹ 6æ»´ +ï¼ˆæŒ‰â€œè¡¥å¼±â€ä»»ä¸€ 6ï½8æ»´ï¼‰`});
  // ç¡å‰/æƒ…ç»ªæ”¾æ¾
  plans.push({name:'ç¡å‰/æƒ…ç»ªå®‰å®šï¼ˆ10mlï¼‰',desc:`è·è·å·´ 8ml + è–°è¡£è‰ 12æ»´ + æœˆæ¡‚/ä¾å…° 6æ»´ + å²©å…°è‰ 4æ»´ + é›ªæ¾ 6æ»´ + ç™½æŸ‘/ä½›æ‰‹ 6æ»´`});
  return plans;
}

/* â€”â€” è®¡ç®—æ¨¡å‹ï¼ˆç®€åŒ–è®¡åˆ†ï¼šå¹²æ”¯å„1åˆ†ï¼‰ â€”â€” */
function wzOf(gz){
  const gan = gz.substring(0,1), zhi = gz.substring(1,2);
  const G = {ç”²:'æœ¨',ä¹™:'æœ¨',ä¸™:'ç«',ä¸:'ç«',æˆŠ:'åœŸ',å·±:'åœŸ',åºš:'é‡‘',è¾›:'é‡‘',å£¬:'æ°´',ç™¸:'æ°´'};
  const Z = {å­:'æ°´',ä¸‘:'åœŸ',å¯…:'æœ¨',å¯:'æœ¨',è¾°:'åœŸ',å·³:'ç«',åˆ:'ç«',æœª:'åœŸ',ç”³:'é‡‘',é…‰:'é‡‘',æˆŒ:'åœŸ',äº¥:'æ°´'};
  return [G[gan], Z[zhi]];
}
function scoreFive(eight){
  const sc = {é‡‘:0,æœ¨:0,æ°´:0,ç«:0,åœŸ:0};
  [eight.y, eight.m, eight.d, eight.t].forEach(gz=>{
    if(!gz) return;
    const [a,b]=wzOf(gz); sc[a]++; sc[b]++;
  });
  return sc;
}
function pickRec(sc){
  const entries = Object.entries(sc).sort((a,b)=>b[1]-a[1]);
  const maxV = entries[0][1], minV = entries[entries.length-1][1];
  const strong = entries.filter(([k,v])=>v===maxV).map(x=>x[0]);
  const weak   = entries.filter(([k,v])=>v===minV).map(x=>x[0]);
  const crystalLines = weak.map(w=>`Â· è¡¥${w}ï¼š${CRYSTALS[w].join(' / ')}`).join('\n');
  return {strong, weak, crystalLines};
}
function two(n){return n<10?'0'+n:n}

function run(){
  const name = document.getElementById('name').value.trim()||'ä½ ';
  const gender = document.getElementById('gender').value;
  const date = document.getElementById('date').value;
  const time = document.getElementById('time').value;
  const tz = parseInt(document.getElementById('tz').value,10)||8;
  let year = parseInt(document.getElementById('flowYear').value,10);
  const tone = document.getElementById('tone').value;

  if(!date){ alert('è¯·å…ˆé€‰æ‹©å…¬å†ç”Ÿæ—¥'); return;}

  const d=new Date(date+'T'+(time||'12:00')+':00');
  const utcMs = d.getTime() - (tz*60*60*1000);
  const loc = new Date(utcMs);
  const y=loc.getUTCFullYear(), m=loc.getUTCMonth()+1, day=loc.getUTCDate();
  const hh=loc.getUTCHours(), mm=loc.getUTCMinutes(), ss=loc.getUTCSeconds();

  const solar = Solar.fromYmdHms(y,m,day,hh,mm,ss);
  const lunar = solar.getLunar();
  const ec = lunar.getEightChar();
  const yearGZ = ec.getYear(), monthGZ = ec.getMonth(), dayGZ = ec.getDay();
  const timeGZ = (time ? ec.getTime() : 'ï¼ˆæœªçŸ¥ï¼‰');

  if(!year){ year = (new Date()).getFullYear(); }
  const liuYearGZ = Lunar.fromYmd(year,1,1).getYearInGanZhi();

  const eight = {y:yearGZ, m:monthGZ, d:dayGZ, t:(time?timeGZ:'')};
  const sc = scoreFive(eight);
  const rec = pickRec(sc);

  // å±•ç¤ºæ’ç›˜
  const chart = [
    `å¹´æŸ±ï¼š${yearGZ}ã€€æœˆæŸ±ï¼š${monthGZ}ã€€æ—¥æŸ±ï¼š${dayGZ}ã€€æ—¶æŸ±ï¼š${timeGZ}`,
    `ç”Ÿè‚–ï¼š${lunar.getYearShengXiao()}ã€€çº³éŸ³ï¼š${lunar.getYearNaYin()} / ${lunar.getMonthNaYin()} / ${lunar.getDayNaYin()}${time?(' / '+lunar.getTimeNaYin()):''}`,
    `äº”è¡Œè®¡åˆ†ï¼ˆç®€åŒ–ï¼‰ï¼šé‡‘${sc.é‡‘} æœ¨${sc.æœ¨} æ°´${sc.æ°´} ç«${sc.ç«} åœŸ${sc.åœŸ}`,
    `æµå¹´ï¼ˆ${year}ï¼‰ï¼š${liuYearGZ}å¹´`
  ].join('\n');
  document.getElementById('chart').textContent = chart;

  // æ ‡ç­¾
  const tags=`<span class="pill">åæ—ºï¼š${rec.strong.join('/')||'â€”'}</span><span class="pill">åå¼±ï¼š${rec.weak.join('/')||'â€”'}</span><span class="pill">å»ºè®®æŒ‚ä»¶ï¼š${CHARMS.slice(0,2).join('ã€')}â€¦</span>`;
  document.getElementById('tags').innerHTML = tags;

  // ç²¾æ²¹è®¡åˆ’ï¼ˆ10mlï¼‰
  const oilPlans = mkOilPlan(rec.weak);

  // è¯­æ°”æ¨¡æ¿ï¼ˆæ¸©æŸ”ä¸ºé»˜è®¤ï¼‰
  const toneLead = {
    gentle: `æˆ‘ä¼šæŠŠé‡ç‚¹è¯´å¾—æ¸©æŸ”æ¸…æ¥šï¼Œè®©ä½ å®‰å¿ƒåšé€‰æ‹©ã€‚ä»¥ä¸‹æ˜¯æ ¹æ®ä½ çš„å…«å­—ä¸${year}å¹´æµå¹´ï¼Œç»™ä½ çš„è´´å¿ƒå»ºè®®ï¼š`,
    professional: `ä»¥ä¸‹ä¸ºåŸºäºå…«å­—å››æŸ±ä¸${year}å¹´å¹²æ”¯æµå¹´çš„ç»“æ„åŒ–å»ºè®®ï¼Œä¾›ä½ åœ¨ä¸åŒåœºæ™¯ä¸­ä½¿ç”¨ã€‚`,
    concise: `é‡ç‚¹å¦‚ä¸‹ï¼š`
  }[tone||'gentle'];

  // å·¦å³æ‰‹é€»è¾‘ï¼ˆç»“åˆä½ ä»¥å¾€ä¹ æƒ¯ï¼šå³æ‰‹æŠ¤èº«åŒ–ç…/åœŸæ°´é‡‘ï¼Œå·¦æ‰‹è´µäººè´¢è¿/æœ¨ç«é‡‘ï¼‰
  const leftRec = `å·¦æ‰‹ï¼ˆè´µäººÂ·è´¢è¿Â·è¡¨è¾¾ï¼‰â†’ ä»¥â€œè¡¥å¼±â€ä¸ºä¸»ï¼š${rec.weak.map(k=>CRYSTALS[k][0]).join('ã€') || 'ç™½æ°´æ™¶'}ï¼Œæ­ ${['ç´«æ°´æ™¶','ç™½æ°´æ™¶'][0]} ç¨³é¢‘ï¼›å…³é”®æ—¶åˆ»å¯åŠ ã€Œ${CHARMS[0]}ã€æˆ–ã€Œ${CHARMS[1]}ã€ã€‚`;
  const rightRec = `å³æ‰‹ï¼ˆæŠ¤èº«Â·è¾¹ç•ŒÂ·ç¨³åœºï¼‰â†’ ${FEATURE_SET.æŠ¤èº«.slice(0,2).join('ã€')} æ‰“åº•ï¼ŒæŒ‰éœ€åŠ ã€Œ${['èŒ¶æ™¶','è™çœ¼çŸ³'][0]}ã€ï¼›éœ€è¦å¼ºåŠ¿å®ˆæŠ¤æ—¶åŠ ã€Œ${CHARMS[2]}ã€æˆ–ã€Œ${CHARMS[3]}ã€ã€‚`;

  // å››ç§æ¨¡å¼
  const modes = [
`â‘  æ—¥å¸¸å¹³è¡¡
- ä¸²æ³•ï¼šç™½æ°´æ™¶æ‰“åº• + â€œè¡¥å¼±â€å„å–1ï½2é¢—ç‚¹ç›ï¼ˆ6mm å…¨ç æ›´è´´è‚¤ï¼‰ 
- è¯´æ˜ï¼šè®©èƒ½é‡å‡è¡¡æµåŠ¨ï¼Œä¸æŠ¢æˆï¼Œé€‚åˆå…¨å¤©å€™ä½©æˆ´ã€‚`,
`â‘¡ å¼€è¿åº”äº‹ï¼ˆé¢è¯•/ç­¾çº¦/è°ˆä»·æ ¼ï¼‰
- ä¸²æ³•ï¼šä»¥â€œè´¢è¿/è´µäººâ€å‘ä¸ºä¸»ï¼š${FEATURE_SET.è´¢è¿.slice(0,3).join('ã€')} + ${FEATURE_SET.è´µäºº.slice(0,2).join('ã€')}
- ç‚¹ç›ï¼šåŠ ã€Œ${CHARMS[0]}ã€æˆ–ã€Œ${CHARMS[1]}ã€ç¨³èµ„é‡‘æµä¸äººç¼˜è¿ã€‚`,
`â‘¢ çµä¿®/é™å¿ƒ
- ä¸²æ³•ï¼šç™½æ°´æ™¶ + ç´«æ°´æ™¶ï¼ˆä¸­å¿ƒç /é’±è¢‹å­ï¼‰ 
- è¯´æ˜ï¼šæ¸…è„‘ã€ç¨³é¢‘ç‡ã€å¸®åŠ©å†…åœ¨çœ‹è§ã€‚`,
`â‘£ åº”æ€¥æŠ¤èº«ï¼ˆçŸ­æœŸï¼‰
- ä¸²æ³•ï¼š${FEATURE_SET.æŠ¤èº«.slice(0,3).join('ã€')} + èŒ¶æ™¶
- è¯´æ˜ï¼šåœ¨äººå¤š/æ‚æ°”ç¯å¢ƒå¿«é€Ÿæ’‘èµ·è¾¹ç•Œï¼Œäº‹æ¯•å¯æ¢å›æ—¥å¸¸æ¬¾ã€‚`
  ].join('\n\n');

  // â€œè¡¥å¼±â€æ°´æ™¶æ¸…å•è¡Œ
  const weakCrystalLines = rec.crystalLines || 'Â· å½“å‰ç»“æ„è¾ƒå‡è¡¡ï¼Œå¯ç”¨ç™½æ°´æ™¶ + ç´«æ°´æ™¶åšæ—¥å¸¸ç¨³é¢‘ã€‚';

  // ç²¾æ²¹æ–‡å­—ï¼ˆ10mlï¼‰
  const oilText = [
    `10ml å¤æ–¹ä½¿ç”¨è¯´æ˜ï¼ˆåŸºåº•æ²¹å»ºè®®è·è·å·´ 8mlï¼‰ï¼š`,
    ...oilPlans.map(p=>`- ${p.name}ï¼š${p.desc}`),
    `æ»´æ•°èŒƒå›´ï¼šæ€»è®¡å»ºè®® 40ï½45 æ»´ï¼›è‚Œè‚¤æ•æ„Ÿå¯é™è‡³ 30ï½35 æ»´ã€‚`
  ].join('\n');

  // WhatsApp æ–‡æ¡ˆ
  const header = `ğŸŒ¿ ${name}${gender?(' Â· '+gender):''}ï½œå…«å­—Â·æµå¹´æ¸©æŸ”è§£è¯´`;
  const base = `å…¬å†ç”Ÿæ—¥ï¼š${y}-${two(m)}-${two(day)} ${time||'æ—¶é—´æœªçŸ¥'}ï¼ˆUTC${tz>=0?'+':''}${tz}ï¼‰
å¹´æŸ±${yearGZ}ï½œæœˆæŸ±${monthGZ}ï½œæ—¥æŸ±${dayGZ}ï½œæ—¶æŸ±${time?timeGZ:'æœªçŸ¥'}
${year}å¹´æµå¹´ï¼š${liuYearGZ}`;

  const trend = `âœ¨ æ€»ä½“æ„Ÿè§‰
- äº”è¡Œåæ—ºï¼š${rec.strong.join('/') || 'â€”'}
- äº”è¡Œåå¼±ï¼š${rec.weak.join('/') || 'â€”'}
- æˆ‘çš„å°æé†’ï¼š${toneLead}`;

  const crystals = `ğŸ’ æ°´æ™¶ç­–ç•¥
${weakCrystalLines}

ğŸ– ä½©æˆ´å»ºè®®
- ${leftRec}
- ${rightRec}

ğŸ§© å››ç§æ¨¡å¼ï¼ˆæŒ‰åœºæ™¯åˆ‡æ¢ï¼‰
${modes}`;

  const oils = `ğŸŒ¸ ç²¾æ²¹å»ºè®®ï¼ˆ10ml é…æ–¹ï¼Œæ»šç /ç‚¹æ¶‚çš†å¯ï¼‰
${oilText}`;

  const tail = `ğŸ’¬ æ¸©æŸ”ç»“è¯­
æ„¿ä½ è¢«æ¸©æŸ”ä»¥å¾…ï¼Œç¨³ä½èŠ‚å¥ã€æ…¢æ…¢å‘å¥½ã€‚æœ‰å˜åŠ¨å…ˆç¨³åœºï¼Œæœ‰æœºä¼šå†å‡ºæ‰‹ï¼›éœ€è¦æˆ‘ä¸€èµ·å¾®è°ƒä¸²æ³•æˆ–é…æ–¹ï¼Œéšæ—¶å‘æˆ‘ã€‚`;

  const wa = [header,'',base,'',trend,'',crystals,'',oils,'',tail].join('\n');
  document.getElementById('wa').value = wa;
}

function copyWA(){
  const el = document.getElementById('wa');
  el.select(); el.setSelectionRange(0, 99999);
  document.execCommand('copy');
  alert('å·²å¤åˆ¶åˆ°å‰ªè´´æ¿ï¼Œå¯ä»¥ç›´æ¥è´´åˆ° WhatsAppã€‚');
}
function downloadTxt(){
  const blob = new Blob([document.getElementById('wa').value],{type:'text/plain;charset=utf-8'});
  const a = document.createElement('a');
  a.href = URL.createObjectURL(blob);
  a.download = 'bazi_wa.txt';
  a.click();
}
</script>
</body>
</html>
